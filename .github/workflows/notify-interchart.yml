# Copy this file to .github/workflows/notify-interchart.yml in any
# Interverse plugin repo to trigger diagram regeneration on push.
#
# Requires: INTERCHART_DISPATCH_TOKEN secret (PAT with repo scope)
# set at the org level or per-repo.

name: Notify Interchart

on:
  push:
    branches: [main]
    paths:
      - '.claude-plugin/plugin.json'
      - 'skills/**/SKILL.md'
      - 'hooks/hooks.json'
      - 'agents/**/*.md'
      - 'commands/**/*.md'

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger interchart regeneration
        env:
          GH_TOKEN: ${{ secrets.INTERCHART_DISPATCH_TOKEN }}
        run: |
          gh api repos/mistakeknot/interchart/dispatches \
            -f event_type=ecosystem-changed \
            -f "client_payload[repo]=${{ github.repository }}" \
            -f "client_payload[sha]=${{ github.sha }}"
